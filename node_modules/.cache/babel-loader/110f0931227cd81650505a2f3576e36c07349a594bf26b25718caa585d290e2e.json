{"ast":null,"code":"import { AddEquation, Color, CustomBlending, DepthTexture, DstAlphaFactor, DstColorFactor, HalfFloatType, MeshNormalMaterial, NearestFilter, NoBlending, ShaderMaterial, UniformsUtils, DepthStencilFormat, UnsignedInt248Type, Vector2, WebGLRenderTarget, ZeroFactor } from 'three';\nimport { Pass, FullScreenQuad } from './Pass.js';\nimport { SAOShader } from '../shaders/SAOShader.js';\nimport { DepthLimitedBlurShader } from '../shaders/DepthLimitedBlurShader.js';\nimport { BlurShaderUtils } from '../shaders/DepthLimitedBlurShader.js';\nimport { CopyShader } from '../shaders/CopyShader.js';\n\n/**\n * SAO implementation inspired from bhouston previous SAO work\n */\n\nclass SAOPass extends Pass {\n  constructor(scene, camera, resolution = new Vector2(256, 256)) {\n    super();\n    this.scene = scene;\n    this.camera = camera;\n    this.clear = true;\n    this.needsSwap = false;\n    this.originalClearColor = new Color();\n    this._oldClearColor = new Color();\n    this.oldClearAlpha = 1;\n    this.params = {\n      output: 0,\n      saoBias: 0.5,\n      saoIntensity: 0.18,\n      saoScale: 1,\n      saoKernelRadius: 100,\n      saoMinResolution: 0,\n      saoBlur: true,\n      saoBlurRadius: 8,\n      saoBlurStdDev: 4,\n      saoBlurDepthCutoff: 0.01\n    };\n    this.resolution = new Vector2(resolution.x, resolution.y);\n    this.saoRenderTarget = new WebGLRenderTarget(this.resolution.x, this.resolution.y, {\n      type: HalfFloatType\n    });\n    this.blurIntermediateRenderTarget = this.saoRenderTarget.clone();\n    const depthTexture = new DepthTexture();\n    depthTexture.format = DepthStencilFormat;\n    depthTexture.type = UnsignedInt248Type;\n    this.normalRenderTarget = new WebGLRenderTarget(this.resolution.x, this.resolution.y, {\n      minFilter: NearestFilter,\n      magFilter: NearestFilter,\n      type: HalfFloatType,\n      depthTexture: depthTexture\n    });\n    this.normalMaterial = new MeshNormalMaterial();\n    this.normalMaterial.blending = NoBlending;\n    this.saoMaterial = new ShaderMaterial({\n      defines: Object.assign({}, SAOShader.defines),\n      fragmentShader: SAOShader.fragmentShader,\n      vertexShader: SAOShader.vertexShader,\n      uniforms: UniformsUtils.clone(SAOShader.uniforms)\n    });\n    this.saoMaterial.extensions.derivatives = true;\n    this.saoMaterial.defines['PERSPECTIVE_CAMERA'] = this.camera.isPerspectiveCamera ? 1 : 0;\n    this.saoMaterial.uniforms['tDepth'].value = depthTexture;\n    this.saoMaterial.uniforms['tNormal'].value = this.normalRenderTarget.texture;\n    this.saoMaterial.uniforms['size'].value.set(this.resolution.x, this.resolution.y);\n    this.saoMaterial.uniforms['cameraInverseProjectionMatrix'].value.copy(this.camera.projectionMatrixInverse);\n    this.saoMaterial.uniforms['cameraProjectionMatrix'].value = this.camera.projectionMatrix;\n    this.saoMaterial.blending = NoBlending;\n    this.vBlurMaterial = new ShaderMaterial({\n      uniforms: UniformsUtils.clone(DepthLimitedBlurShader.uniforms),\n      defines: Object.assign({}, DepthLimitedBlurShader.defines),\n      vertexShader: DepthLimitedBlurShader.vertexShader,\n      fragmentShader: DepthLimitedBlurShader.fragmentShader\n    });\n    this.vBlurMaterial.defines['DEPTH_PACKING'] = 0;\n    this.vBlurMaterial.defines['PERSPECTIVE_CAMERA'] = this.camera.isPerspectiveCamera ? 1 : 0;\n    this.vBlurMaterial.uniforms['tDiffuse'].value = this.saoRenderTarget.texture;\n    this.vBlurMaterial.uniforms['tDepth'].value = depthTexture;\n    this.vBlurMaterial.uniforms['size'].value.set(this.resolution.x, this.resolution.y);\n    this.vBlurMaterial.blending = NoBlending;\n    this.hBlurMaterial = new ShaderMaterial({\n      uniforms: UniformsUtils.clone(DepthLimitedBlurShader.uniforms),\n      defines: Object.assign({}, DepthLimitedBlurShader.defines),\n      vertexShader: DepthLimitedBlurShader.vertexShader,\n      fragmentShader: DepthLimitedBlurShader.fragmentShader\n    });\n    this.hBlurMaterial.defines['DEPTH_PACKING'] = 0;\n    this.hBlurMaterial.defines['PERSPECTIVE_CAMERA'] = this.camera.isPerspectiveCamera ? 1 : 0;\n    this.hBlurMaterial.uniforms['tDiffuse'].value = this.blurIntermediateRenderTarget.texture;\n    this.hBlurMaterial.uniforms['tDepth'].value = depthTexture;\n    this.hBlurMaterial.uniforms['size'].value.set(this.resolution.x, this.resolution.y);\n    this.hBlurMaterial.blending = NoBlending;\n    this.materialCopy = new ShaderMaterial({\n      uniforms: UniformsUtils.clone(CopyShader.uniforms),\n      vertexShader: CopyShader.vertexShader,\n      fragmentShader: CopyShader.fragmentShader,\n      blending: NoBlending\n    });\n    this.materialCopy.transparent = true;\n    this.materialCopy.depthTest = false;\n    this.materialCopy.depthWrite = false;\n    this.materialCopy.blending = CustomBlending;\n    this.materialCopy.blendSrc = DstColorFactor;\n    this.materialCopy.blendDst = ZeroFactor;\n    this.materialCopy.blendEquation = AddEquation;\n    this.materialCopy.blendSrcAlpha = DstAlphaFactor;\n    this.materialCopy.blendDstAlpha = ZeroFactor;\n    this.materialCopy.blendEquationAlpha = AddEquation;\n    this.fsQuad = new FullScreenQuad(null);\n  }\n  render(renderer, writeBuffer, readBuffer /*, deltaTime, maskActive*/) {\n    // Rendering readBuffer first when rendering to screen\n    if (this.renderToScreen) {\n      this.materialCopy.blending = NoBlending;\n      this.materialCopy.uniforms['tDiffuse'].value = readBuffer.texture;\n      this.materialCopy.needsUpdate = true;\n      this.renderPass(renderer, this.materialCopy, null);\n    }\n    renderer.getClearColor(this._oldClearColor);\n    this.oldClearAlpha = renderer.getClearAlpha();\n    const oldAutoClear = renderer.autoClear;\n    renderer.autoClear = false;\n    this.saoMaterial.uniforms['bias'].value = this.params.saoBias;\n    this.saoMaterial.uniforms['intensity'].value = this.params.saoIntensity;\n    this.saoMaterial.uniforms['scale'].value = this.params.saoScale;\n    this.saoMaterial.uniforms['kernelRadius'].value = this.params.saoKernelRadius;\n    this.saoMaterial.uniforms['minResolution'].value = this.params.saoMinResolution;\n    this.saoMaterial.uniforms['cameraNear'].value = this.camera.near;\n    this.saoMaterial.uniforms['cameraFar'].value = this.camera.far;\n    // this.saoMaterial.uniforms['randomSeed'].value = Math.random();\n\n    const depthCutoff = this.params.saoBlurDepthCutoff * (this.camera.far - this.camera.near);\n    this.vBlurMaterial.uniforms['depthCutoff'].value = depthCutoff;\n    this.hBlurMaterial.uniforms['depthCutoff'].value = depthCutoff;\n    this.vBlurMaterial.uniforms['cameraNear'].value = this.camera.near;\n    this.vBlurMaterial.uniforms['cameraFar'].value = this.camera.far;\n    this.hBlurMaterial.uniforms['cameraNear'].value = this.camera.near;\n    this.hBlurMaterial.uniforms['cameraFar'].value = this.camera.far;\n    this.params.saoBlurRadius = Math.floor(this.params.saoBlurRadius);\n    if (this.prevStdDev !== this.params.saoBlurStdDev || this.prevNumSamples !== this.params.saoBlurRadius) {\n      BlurShaderUtils.configure(this.vBlurMaterial, this.params.saoBlurRadius, this.params.saoBlurStdDev, new Vector2(0, 1));\n      BlurShaderUtils.configure(this.hBlurMaterial, this.params.saoBlurRadius, this.params.saoBlurStdDev, new Vector2(1, 0));\n      this.prevStdDev = this.params.saoBlurStdDev;\n      this.prevNumSamples = this.params.saoBlurRadius;\n    }\n\n    // render normal and depth\n    this.renderOverride(renderer, this.normalMaterial, this.normalRenderTarget, 0x7777ff, 1.0);\n\n    // Rendering SAO texture\n    this.renderPass(renderer, this.saoMaterial, this.saoRenderTarget, 0xffffff, 1.0);\n\n    // Blurring SAO texture\n    if (this.params.saoBlur) {\n      this.renderPass(renderer, this.vBlurMaterial, this.blurIntermediateRenderTarget, 0xffffff, 1.0);\n      this.renderPass(renderer, this.hBlurMaterial, this.saoRenderTarget, 0xffffff, 1.0);\n    }\n    const outputMaterial = this.materialCopy;\n\n    // Setting up SAO rendering\n    if (this.params.output === SAOPass.OUTPUT.Normal) {\n      this.materialCopy.uniforms['tDiffuse'].value = this.normalRenderTarget.texture;\n      this.materialCopy.needsUpdate = true;\n    } else {\n      this.materialCopy.uniforms['tDiffuse'].value = this.saoRenderTarget.texture;\n      this.materialCopy.needsUpdate = true;\n    }\n\n    // Blending depends on output\n    if (this.params.output === SAOPass.OUTPUT.Default) {\n      outputMaterial.blending = CustomBlending;\n    } else {\n      outputMaterial.blending = NoBlending;\n    }\n\n    // Rendering SAOPass result on top of previous pass\n    this.renderPass(renderer, outputMaterial, this.renderToScreen ? null : readBuffer);\n    renderer.setClearColor(this._oldClearColor, this.oldClearAlpha);\n    renderer.autoClear = oldAutoClear;\n  }\n  renderPass(renderer, passMaterial, renderTarget, clearColor, clearAlpha) {\n    // save original state\n    renderer.getClearColor(this.originalClearColor);\n    const originalClearAlpha = renderer.getClearAlpha();\n    const originalAutoClear = renderer.autoClear;\n    renderer.setRenderTarget(renderTarget);\n\n    // setup pass state\n    renderer.autoClear = false;\n    if (clearColor !== undefined && clearColor !== null) {\n      renderer.setClearColor(clearColor);\n      renderer.setClearAlpha(clearAlpha || 0.0);\n      renderer.clear();\n    }\n    this.fsQuad.material = passMaterial;\n    this.fsQuad.render(renderer);\n\n    // restore original state\n    renderer.autoClear = originalAutoClear;\n    renderer.setClearColor(this.originalClearColor);\n    renderer.setClearAlpha(originalClearAlpha);\n  }\n  renderOverride(renderer, overrideMaterial, renderTarget, clearColor, clearAlpha) {\n    renderer.getClearColor(this.originalClearColor);\n    const originalClearAlpha = renderer.getClearAlpha();\n    const originalAutoClear = renderer.autoClear;\n    renderer.setRenderTarget(renderTarget);\n    renderer.autoClear = false;\n    clearColor = overrideMaterial.clearColor || clearColor;\n    clearAlpha = overrideMaterial.clearAlpha || clearAlpha;\n    if (clearColor !== undefined && clearColor !== null) {\n      renderer.setClearColor(clearColor);\n      renderer.setClearAlpha(clearAlpha || 0.0);\n      renderer.clear();\n    }\n    this.scene.overrideMaterial = overrideMaterial;\n    renderer.render(this.scene, this.camera);\n    this.scene.overrideMaterial = null;\n\n    // restore original state\n    renderer.autoClear = originalAutoClear;\n    renderer.setClearColor(this.originalClearColor);\n    renderer.setClearAlpha(originalClearAlpha);\n  }\n  setSize(width, height) {\n    this.saoRenderTarget.setSize(width, height);\n    this.blurIntermediateRenderTarget.setSize(width, height);\n    this.normalRenderTarget.setSize(width, height);\n    this.saoMaterial.uniforms['size'].value.set(width, height);\n    this.saoMaterial.uniforms['cameraInverseProjectionMatrix'].value.copy(this.camera.projectionMatrixInverse);\n    this.saoMaterial.uniforms['cameraProjectionMatrix'].value = this.camera.projectionMatrix;\n    this.saoMaterial.needsUpdate = true;\n    this.vBlurMaterial.uniforms['size'].value.set(width, height);\n    this.vBlurMaterial.needsUpdate = true;\n    this.hBlurMaterial.uniforms['size'].value.set(width, height);\n    this.hBlurMaterial.needsUpdate = true;\n  }\n  dispose() {\n    this.saoRenderTarget.dispose();\n    this.blurIntermediateRenderTarget.dispose();\n    this.normalRenderTarget.dispose();\n    this.normalMaterial.dispose();\n    this.saoMaterial.dispose();\n    this.vBlurMaterial.dispose();\n    this.hBlurMaterial.dispose();\n    this.materialCopy.dispose();\n    this.fsQuad.dispose();\n  }\n}\nSAOPass.OUTPUT = {\n  'Default': 0,\n  'SAO': 1,\n  'Normal': 2\n};\nexport { SAOPass };","map":{"version":3,"names":["AddEquation","Color","CustomBlending","DepthTexture","DstAlphaFactor","DstColorFactor","HalfFloatType","MeshNormalMaterial","NearestFilter","NoBlending","ShaderMaterial","UniformsUtils","DepthStencilFormat","UnsignedInt248Type","Vector2","WebGLRenderTarget","ZeroFactor","Pass","FullScreenQuad","SAOShader","DepthLimitedBlurShader","BlurShaderUtils","CopyShader","SAOPass","constructor","scene","camera","resolution","clear","needsSwap","originalClearColor","_oldClearColor","oldClearAlpha","params","output","saoBias","saoIntensity","saoScale","saoKernelRadius","saoMinResolution","saoBlur","saoBlurRadius","saoBlurStdDev","saoBlurDepthCutoff","x","y","saoRenderTarget","type","blurIntermediateRenderTarget","clone","depthTexture","format","normalRenderTarget","minFilter","magFilter","normalMaterial","blending","saoMaterial","defines","Object","assign","fragmentShader","vertexShader","uniforms","extensions","derivatives","isPerspectiveCamera","value","texture","set","copy","projectionMatrixInverse","projectionMatrix","vBlurMaterial","hBlurMaterial","materialCopy","transparent","depthTest","depthWrite","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","fsQuad","render","renderer","writeBuffer","readBuffer","renderToScreen","needsUpdate","renderPass","getClearColor","getClearAlpha","oldAutoClear","autoClear","near","far","depthCutoff","Math","floor","prevStdDev","prevNumSamples","configure","renderOverride","outputMaterial","OUTPUT","Normal","Default","setClearColor","passMaterial","renderTarget","clearColor","clearAlpha","originalClearAlpha","originalAutoClear","setRenderTarget","undefined","setClearAlpha","material","overrideMaterial","setSize","width","height","dispose"],"sources":["/home/ervin/Escritorio/integrador/Projecto-Integrador-1-Game/node_modules/three/examples/jsm/postprocessing/SAOPass.js"],"sourcesContent":["import {\n\tAddEquation,\n\tColor,\n\tCustomBlending,\n\tDepthTexture,\n\tDstAlphaFactor,\n\tDstColorFactor,\n\tHalfFloatType,\n\tMeshNormalMaterial,\n\tNearestFilter,\n\tNoBlending,\n\tShaderMaterial,\n\tUniformsUtils,\n\tDepthStencilFormat,\n\tUnsignedInt248Type,\n\tVector2,\n\tWebGLRenderTarget,\n\tZeroFactor\n} from 'three';\nimport { Pass, FullScreenQuad } from './Pass.js';\nimport { SAOShader } from '../shaders/SAOShader.js';\nimport { DepthLimitedBlurShader } from '../shaders/DepthLimitedBlurShader.js';\nimport { BlurShaderUtils } from '../shaders/DepthLimitedBlurShader.js';\nimport { CopyShader } from '../shaders/CopyShader.js';\n\n/**\n * SAO implementation inspired from bhouston previous SAO work\n */\n\nclass SAOPass extends Pass {\n\n\tconstructor( scene, camera, resolution = new Vector2( 256, 256 ) ) {\n\n\t\tsuper();\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.clear = true;\n\t\tthis.needsSwap = false;\n\n\t\tthis.originalClearColor = new Color();\n\t\tthis._oldClearColor = new Color();\n\t\tthis.oldClearAlpha = 1;\n\n\t\tthis.params = {\n\t\t\toutput: 0,\n\t\t\tsaoBias: 0.5,\n\t\t\tsaoIntensity: 0.18,\n\t\t\tsaoScale: 1,\n\t\t\tsaoKernelRadius: 100,\n\t\t\tsaoMinResolution: 0,\n\t\t\tsaoBlur: true,\n\t\t\tsaoBlurRadius: 8,\n\t\t\tsaoBlurStdDev: 4,\n\t\t\tsaoBlurDepthCutoff: 0.01\n\t\t};\n\n\t\tthis.resolution = new Vector2( resolution.x, resolution.y );\n\n\t\tthis.saoRenderTarget = new WebGLRenderTarget( this.resolution.x, this.resolution.y, { type: HalfFloatType } );\n\t\tthis.blurIntermediateRenderTarget = this.saoRenderTarget.clone();\n\n\t\tconst depthTexture = new DepthTexture();\n\t\tdepthTexture.format = DepthStencilFormat;\n\t\tdepthTexture.type = UnsignedInt248Type;\n\n\t\tthis.normalRenderTarget = new WebGLRenderTarget( this.resolution.x, this.resolution.y, {\n\t\t\tminFilter: NearestFilter,\n\t\t\tmagFilter: NearestFilter,\n\t\t\ttype: HalfFloatType,\n\t\t\tdepthTexture: depthTexture\n\t\t} );\n\n\t\tthis.normalMaterial = new MeshNormalMaterial();\n\t\tthis.normalMaterial.blending = NoBlending;\n\n\t\tthis.saoMaterial = new ShaderMaterial( {\n\t\t\tdefines: Object.assign( {}, SAOShader.defines ),\n\t\t\tfragmentShader: SAOShader.fragmentShader,\n\t\t\tvertexShader: SAOShader.vertexShader,\n\t\t\tuniforms: UniformsUtils.clone( SAOShader.uniforms )\n\t\t} );\n\t\tthis.saoMaterial.extensions.derivatives = true;\n\t\tthis.saoMaterial.defines[ 'PERSPECTIVE_CAMERA' ] = this.camera.isPerspectiveCamera ? 1 : 0;\n\t\tthis.saoMaterial.uniforms[ 'tDepth' ].value = depthTexture;\n\t\tthis.saoMaterial.uniforms[ 'tNormal' ].value = this.normalRenderTarget.texture;\n\t\tthis.saoMaterial.uniforms[ 'size' ].value.set( this.resolution.x, this.resolution.y );\n\t\tthis.saoMaterial.uniforms[ 'cameraInverseProjectionMatrix' ].value.copy( this.camera.projectionMatrixInverse );\n\t\tthis.saoMaterial.uniforms[ 'cameraProjectionMatrix' ].value = this.camera.projectionMatrix;\n\t\tthis.saoMaterial.blending = NoBlending;\n\n\t\tthis.vBlurMaterial = new ShaderMaterial( {\n\t\t\tuniforms: UniformsUtils.clone( DepthLimitedBlurShader.uniforms ),\n\t\t\tdefines: Object.assign( {}, DepthLimitedBlurShader.defines ),\n\t\t\tvertexShader: DepthLimitedBlurShader.vertexShader,\n\t\t\tfragmentShader: DepthLimitedBlurShader.fragmentShader\n\t\t} );\n\t\tthis.vBlurMaterial.defines[ 'DEPTH_PACKING' ] = 0;\n\t\tthis.vBlurMaterial.defines[ 'PERSPECTIVE_CAMERA' ] = this.camera.isPerspectiveCamera ? 1 : 0;\n\t\tthis.vBlurMaterial.uniforms[ 'tDiffuse' ].value = this.saoRenderTarget.texture;\n\t\tthis.vBlurMaterial.uniforms[ 'tDepth' ].value = depthTexture;\n\t\tthis.vBlurMaterial.uniforms[ 'size' ].value.set( this.resolution.x, this.resolution.y );\n\t\tthis.vBlurMaterial.blending = NoBlending;\n\n\t\tthis.hBlurMaterial = new ShaderMaterial( {\n\t\t\tuniforms: UniformsUtils.clone( DepthLimitedBlurShader.uniforms ),\n\t\t\tdefines: Object.assign( {}, DepthLimitedBlurShader.defines ),\n\t\t\tvertexShader: DepthLimitedBlurShader.vertexShader,\n\t\t\tfragmentShader: DepthLimitedBlurShader.fragmentShader\n\t\t} );\n\t\tthis.hBlurMaterial.defines[ 'DEPTH_PACKING' ] = 0;\n\t\tthis.hBlurMaterial.defines[ 'PERSPECTIVE_CAMERA' ] = this.camera.isPerspectiveCamera ? 1 : 0;\n\t\tthis.hBlurMaterial.uniforms[ 'tDiffuse' ].value = this.blurIntermediateRenderTarget.texture;\n\t\tthis.hBlurMaterial.uniforms[ 'tDepth' ].value = depthTexture;\n\t\tthis.hBlurMaterial.uniforms[ 'size' ].value.set( this.resolution.x, this.resolution.y );\n\t\tthis.hBlurMaterial.blending = NoBlending;\n\n\t\tthis.materialCopy = new ShaderMaterial( {\n\t\t\tuniforms: UniformsUtils.clone( CopyShader.uniforms ),\n\t\t\tvertexShader: CopyShader.vertexShader,\n\t\t\tfragmentShader: CopyShader.fragmentShader,\n\t\t\tblending: NoBlending\n\t\t} );\n\t\tthis.materialCopy.transparent = true;\n\t\tthis.materialCopy.depthTest = false;\n\t\tthis.materialCopy.depthWrite = false;\n\t\tthis.materialCopy.blending = CustomBlending;\n\t\tthis.materialCopy.blendSrc = DstColorFactor;\n\t\tthis.materialCopy.blendDst = ZeroFactor;\n\t\tthis.materialCopy.blendEquation = AddEquation;\n\t\tthis.materialCopy.blendSrcAlpha = DstAlphaFactor;\n\t\tthis.materialCopy.blendDstAlpha = ZeroFactor;\n\t\tthis.materialCopy.blendEquationAlpha = AddEquation;\n\n\t\tthis.fsQuad = new FullScreenQuad( null );\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer/*, deltaTime, maskActive*/ ) {\n\n\t\t// Rendering readBuffer first when rendering to screen\n\t\tif ( this.renderToScreen ) {\n\n\t\t\tthis.materialCopy.blending = NoBlending;\n\t\t\tthis.materialCopy.uniforms[ 'tDiffuse' ].value = readBuffer.texture;\n\t\t\tthis.materialCopy.needsUpdate = true;\n\t\t\tthis.renderPass( renderer, this.materialCopy, null );\n\n\t\t}\n\n\t\trenderer.getClearColor( this._oldClearColor );\n\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\t\tconst oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tthis.saoMaterial.uniforms[ 'bias' ].value = this.params.saoBias;\n\t\tthis.saoMaterial.uniforms[ 'intensity' ].value = this.params.saoIntensity;\n\t\tthis.saoMaterial.uniforms[ 'scale' ].value = this.params.saoScale;\n\t\tthis.saoMaterial.uniforms[ 'kernelRadius' ].value = this.params.saoKernelRadius;\n\t\tthis.saoMaterial.uniforms[ 'minResolution' ].value = this.params.saoMinResolution;\n\t\tthis.saoMaterial.uniforms[ 'cameraNear' ].value = this.camera.near;\n\t\tthis.saoMaterial.uniforms[ 'cameraFar' ].value = this.camera.far;\n\t\t// this.saoMaterial.uniforms['randomSeed'].value = Math.random();\n\n\t\tconst depthCutoff = this.params.saoBlurDepthCutoff * ( this.camera.far - this.camera.near );\n\t\tthis.vBlurMaterial.uniforms[ 'depthCutoff' ].value = depthCutoff;\n\t\tthis.hBlurMaterial.uniforms[ 'depthCutoff' ].value = depthCutoff;\n\n\t\tthis.vBlurMaterial.uniforms[ 'cameraNear' ].value = this.camera.near;\n\t\tthis.vBlurMaterial.uniforms[ 'cameraFar' ].value = this.camera.far;\n\t\tthis.hBlurMaterial.uniforms[ 'cameraNear' ].value = this.camera.near;\n\t\tthis.hBlurMaterial.uniforms[ 'cameraFar' ].value = this.camera.far;\n\n\t\tthis.params.saoBlurRadius = Math.floor( this.params.saoBlurRadius );\n\t\tif ( ( this.prevStdDev !== this.params.saoBlurStdDev ) || ( this.prevNumSamples !== this.params.saoBlurRadius ) ) {\n\n\t\t\tBlurShaderUtils.configure( this.vBlurMaterial, this.params.saoBlurRadius, this.params.saoBlurStdDev, new Vector2( 0, 1 ) );\n\t\t\tBlurShaderUtils.configure( this.hBlurMaterial, this.params.saoBlurRadius, this.params.saoBlurStdDev, new Vector2( 1, 0 ) );\n\t\t\tthis.prevStdDev = this.params.saoBlurStdDev;\n\t\t\tthis.prevNumSamples = this.params.saoBlurRadius;\n\n\t\t}\n\n\t\t// render normal and depth\n\t\tthis.renderOverride( renderer, this.normalMaterial, this.normalRenderTarget, 0x7777ff, 1.0 );\n\n\t\t// Rendering SAO texture\n\t\tthis.renderPass( renderer, this.saoMaterial, this.saoRenderTarget, 0xffffff, 1.0 );\n\n\t\t// Blurring SAO texture\n\t\tif ( this.params.saoBlur ) {\n\n\t\t\tthis.renderPass( renderer, this.vBlurMaterial, this.blurIntermediateRenderTarget, 0xffffff, 1.0 );\n\t\t\tthis.renderPass( renderer, this.hBlurMaterial, this.saoRenderTarget, 0xffffff, 1.0 );\n\n\t\t}\n\n\t\tconst outputMaterial = this.materialCopy;\n\n\t\t// Setting up SAO rendering\n\t\tif ( this.params.output === SAOPass.OUTPUT.Normal ) {\n\n\t\t\tthis.materialCopy.uniforms[ 'tDiffuse' ].value = this.normalRenderTarget.texture;\n\t\t\tthis.materialCopy.needsUpdate = true;\n\n\t\t} else {\n\n\t\t\tthis.materialCopy.uniforms[ 'tDiffuse' ].value = this.saoRenderTarget.texture;\n\t\t\tthis.materialCopy.needsUpdate = true;\n\n\t\t}\n\n\t\t// Blending depends on output\n\t\tif ( this.params.output === SAOPass.OUTPUT.Default ) {\n\n\t\t\toutputMaterial.blending = CustomBlending;\n\n\t\t} else {\n\n\t\t\toutputMaterial.blending = NoBlending;\n\n\t\t}\n\n\t\t// Rendering SAOPass result on top of previous pass\n\t\tthis.renderPass( renderer, outputMaterial, this.renderToScreen ? null : readBuffer );\n\n\t\trenderer.setClearColor( this._oldClearColor, this.oldClearAlpha );\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n\trenderPass( renderer, passMaterial, renderTarget, clearColor, clearAlpha ) {\n\n\t\t// save original state\n\t\trenderer.getClearColor( this.originalClearColor );\n\t\tconst originalClearAlpha = renderer.getClearAlpha();\n\t\tconst originalAutoClear = renderer.autoClear;\n\n\t\trenderer.setRenderTarget( renderTarget );\n\n\t\t// setup pass state\n\t\trenderer.autoClear = false;\n\t\tif ( ( clearColor !== undefined ) && ( clearColor !== null ) ) {\n\n\t\t\trenderer.setClearColor( clearColor );\n\t\t\trenderer.setClearAlpha( clearAlpha || 0.0 );\n\t\t\trenderer.clear();\n\n\t\t}\n\n\t\tthis.fsQuad.material = passMaterial;\n\t\tthis.fsQuad.render( renderer );\n\n\t\t// restore original state\n\t\trenderer.autoClear = originalAutoClear;\n\t\trenderer.setClearColor( this.originalClearColor );\n\t\trenderer.setClearAlpha( originalClearAlpha );\n\n\t}\n\n\trenderOverride( renderer, overrideMaterial, renderTarget, clearColor, clearAlpha ) {\n\n\t\trenderer.getClearColor( this.originalClearColor );\n\t\tconst originalClearAlpha = renderer.getClearAlpha();\n\t\tconst originalAutoClear = renderer.autoClear;\n\n\t\trenderer.setRenderTarget( renderTarget );\n\t\trenderer.autoClear = false;\n\n\t\tclearColor = overrideMaterial.clearColor || clearColor;\n\t\tclearAlpha = overrideMaterial.clearAlpha || clearAlpha;\n\t\tif ( ( clearColor !== undefined ) && ( clearColor !== null ) ) {\n\n\t\t\trenderer.setClearColor( clearColor );\n\t\t\trenderer.setClearAlpha( clearAlpha || 0.0 );\n\t\t\trenderer.clear();\n\n\t\t}\n\n\t\tthis.scene.overrideMaterial = overrideMaterial;\n\t\trenderer.render( this.scene, this.camera );\n\t\tthis.scene.overrideMaterial = null;\n\n\t\t// restore original state\n\t\trenderer.autoClear = originalAutoClear;\n\t\trenderer.setClearColor( this.originalClearColor );\n\t\trenderer.setClearAlpha( originalClearAlpha );\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis.saoRenderTarget.setSize( width, height );\n\t\tthis.blurIntermediateRenderTarget.setSize( width, height );\n\t\tthis.normalRenderTarget.setSize( width, height );\n\n\t\tthis.saoMaterial.uniforms[ 'size' ].value.set( width, height );\n\t\tthis.saoMaterial.uniforms[ 'cameraInverseProjectionMatrix' ].value.copy( this.camera.projectionMatrixInverse );\n\t\tthis.saoMaterial.uniforms[ 'cameraProjectionMatrix' ].value = this.camera.projectionMatrix;\n\t\tthis.saoMaterial.needsUpdate = true;\n\n\t\tthis.vBlurMaterial.uniforms[ 'size' ].value.set( width, height );\n\t\tthis.vBlurMaterial.needsUpdate = true;\n\n\t\tthis.hBlurMaterial.uniforms[ 'size' ].value.set( width, height );\n\t\tthis.hBlurMaterial.needsUpdate = true;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.saoRenderTarget.dispose();\n\t\tthis.blurIntermediateRenderTarget.dispose();\n\t\tthis.normalRenderTarget.dispose();\n\n\t\tthis.normalMaterial.dispose();\n\t\tthis.saoMaterial.dispose();\n\t\tthis.vBlurMaterial.dispose();\n\t\tthis.hBlurMaterial.dispose();\n\t\tthis.materialCopy.dispose();\n\n\t\tthis.fsQuad.dispose();\n\n\t}\n\n}\n\nSAOPass.OUTPUT = {\n\t'Default': 0,\n\t'SAO': 1,\n\t'Normal': 2\n};\n\nexport { SAOPass };\n"],"mappings":"AAAA,SACCA,WAAW,EACXC,KAAK,EACLC,cAAc,EACdC,YAAY,EACZC,cAAc,EACdC,cAAc,EACdC,aAAa,EACbC,kBAAkB,EAClBC,aAAa,EACbC,UAAU,EACVC,cAAc,EACdC,aAAa,EACbC,kBAAkB,EAClBC,kBAAkB,EAClBC,OAAO,EACPC,iBAAiB,EACjBC,UAAU,QACJ,OAAO;AACd,SAASC,IAAI,EAAEC,cAAc,QAAQ,WAAW;AAChD,SAASC,SAAS,QAAQ,yBAAyB;AACnD,SAASC,sBAAsB,QAAQ,sCAAsC;AAC7E,SAASC,eAAe,QAAQ,sCAAsC;AACtE,SAASC,UAAU,QAAQ,0BAA0B;;AAErD;AACA;AACA;;AAEA,MAAMC,OAAO,SAASN,IAAI,CAAC;EAE1BO,WAAWA,CAAEC,KAAK,EAAEC,MAAM,EAAEC,UAAU,GAAG,IAAIb,OAAO,CAAE,GAAG,EAAE,GAAI,CAAC,EAAG;IAElE,KAAK,CAAC,CAAC;IAEP,IAAI,CAACW,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,MAAM,GAAGA,MAAM;IAEpB,IAAI,CAACE,KAAK,GAAG,IAAI;IACjB,IAAI,CAACC,SAAS,GAAG,KAAK;IAEtB,IAAI,CAACC,kBAAkB,GAAG,IAAI7B,KAAK,CAAC,CAAC;IACrC,IAAI,CAAC8B,cAAc,GAAG,IAAI9B,KAAK,CAAC,CAAC;IACjC,IAAI,CAAC+B,aAAa,GAAG,CAAC;IAEtB,IAAI,CAACC,MAAM,GAAG;MACbC,MAAM,EAAE,CAAC;MACTC,OAAO,EAAE,GAAG;MACZC,YAAY,EAAE,IAAI;MAClBC,QAAQ,EAAE,CAAC;MACXC,eAAe,EAAE,GAAG;MACpBC,gBAAgB,EAAE,CAAC;MACnBC,OAAO,EAAE,IAAI;MACbC,aAAa,EAAE,CAAC;MAChBC,aAAa,EAAE,CAAC;MAChBC,kBAAkB,EAAE;IACrB,CAAC;IAED,IAAI,CAAChB,UAAU,GAAG,IAAIb,OAAO,CAAEa,UAAU,CAACiB,CAAC,EAAEjB,UAAU,CAACkB,CAAE,CAAC;IAE3D,IAAI,CAACC,eAAe,GAAG,IAAI/B,iBAAiB,CAAE,IAAI,CAACY,UAAU,CAACiB,CAAC,EAAE,IAAI,CAACjB,UAAU,CAACkB,CAAC,EAAE;MAAEE,IAAI,EAAEzC;IAAc,CAAE,CAAC;IAC7G,IAAI,CAAC0C,4BAA4B,GAAG,IAAI,CAACF,eAAe,CAACG,KAAK,CAAC,CAAC;IAEhE,MAAMC,YAAY,GAAG,IAAI/C,YAAY,CAAC,CAAC;IACvC+C,YAAY,CAACC,MAAM,GAAGvC,kBAAkB;IACxCsC,YAAY,CAACH,IAAI,GAAGlC,kBAAkB;IAEtC,IAAI,CAACuC,kBAAkB,GAAG,IAAIrC,iBAAiB,CAAE,IAAI,CAACY,UAAU,CAACiB,CAAC,EAAE,IAAI,CAACjB,UAAU,CAACkB,CAAC,EAAE;MACtFQ,SAAS,EAAE7C,aAAa;MACxB8C,SAAS,EAAE9C,aAAa;MACxBuC,IAAI,EAAEzC,aAAa;MACnB4C,YAAY,EAAEA;IACf,CAAE,CAAC;IAEH,IAAI,CAACK,cAAc,GAAG,IAAIhD,kBAAkB,CAAC,CAAC;IAC9C,IAAI,CAACgD,cAAc,CAACC,QAAQ,GAAG/C,UAAU;IAEzC,IAAI,CAACgD,WAAW,GAAG,IAAI/C,cAAc,CAAE;MACtCgD,OAAO,EAAEC,MAAM,CAACC,MAAM,CAAE,CAAC,CAAC,EAAEzC,SAAS,CAACuC,OAAQ,CAAC;MAC/CG,cAAc,EAAE1C,SAAS,CAAC0C,cAAc;MACxCC,YAAY,EAAE3C,SAAS,CAAC2C,YAAY;MACpCC,QAAQ,EAAEpD,aAAa,CAACsC,KAAK,CAAE9B,SAAS,CAAC4C,QAAS;IACnD,CAAE,CAAC;IACH,IAAI,CAACN,WAAW,CAACO,UAAU,CAACC,WAAW,GAAG,IAAI;IAC9C,IAAI,CAACR,WAAW,CAACC,OAAO,CAAE,oBAAoB,CAAE,GAAG,IAAI,CAAChC,MAAM,CAACwC,mBAAmB,GAAG,CAAC,GAAG,CAAC;IAC1F,IAAI,CAACT,WAAW,CAACM,QAAQ,CAAE,QAAQ,CAAE,CAACI,KAAK,GAAGjB,YAAY;IAC1D,IAAI,CAACO,WAAW,CAACM,QAAQ,CAAE,SAAS,CAAE,CAACI,KAAK,GAAG,IAAI,CAACf,kBAAkB,CAACgB,OAAO;IAC9E,IAAI,CAACX,WAAW,CAACM,QAAQ,CAAE,MAAM,CAAE,CAACI,KAAK,CAACE,GAAG,CAAE,IAAI,CAAC1C,UAAU,CAACiB,CAAC,EAAE,IAAI,CAACjB,UAAU,CAACkB,CAAE,CAAC;IACrF,IAAI,CAACY,WAAW,CAACM,QAAQ,CAAE,+BAA+B,CAAE,CAACI,KAAK,CAACG,IAAI,CAAE,IAAI,CAAC5C,MAAM,CAAC6C,uBAAwB,CAAC;IAC9G,IAAI,CAACd,WAAW,CAACM,QAAQ,CAAE,wBAAwB,CAAE,CAACI,KAAK,GAAG,IAAI,CAACzC,MAAM,CAAC8C,gBAAgB;IAC1F,IAAI,CAACf,WAAW,CAACD,QAAQ,GAAG/C,UAAU;IAEtC,IAAI,CAACgE,aAAa,GAAG,IAAI/D,cAAc,CAAE;MACxCqD,QAAQ,EAAEpD,aAAa,CAACsC,KAAK,CAAE7B,sBAAsB,CAAC2C,QAAS,CAAC;MAChEL,OAAO,EAAEC,MAAM,CAACC,MAAM,CAAE,CAAC,CAAC,EAAExC,sBAAsB,CAACsC,OAAQ,CAAC;MAC5DI,YAAY,EAAE1C,sBAAsB,CAAC0C,YAAY;MACjDD,cAAc,EAAEzC,sBAAsB,CAACyC;IACxC,CAAE,CAAC;IACH,IAAI,CAACY,aAAa,CAACf,OAAO,CAAE,eAAe,CAAE,GAAG,CAAC;IACjD,IAAI,CAACe,aAAa,CAACf,OAAO,CAAE,oBAAoB,CAAE,GAAG,IAAI,CAAChC,MAAM,CAACwC,mBAAmB,GAAG,CAAC,GAAG,CAAC;IAC5F,IAAI,CAACO,aAAa,CAACV,QAAQ,CAAE,UAAU,CAAE,CAACI,KAAK,GAAG,IAAI,CAACrB,eAAe,CAACsB,OAAO;IAC9E,IAAI,CAACK,aAAa,CAACV,QAAQ,CAAE,QAAQ,CAAE,CAACI,KAAK,GAAGjB,YAAY;IAC5D,IAAI,CAACuB,aAAa,CAACV,QAAQ,CAAE,MAAM,CAAE,CAACI,KAAK,CAACE,GAAG,CAAE,IAAI,CAAC1C,UAAU,CAACiB,CAAC,EAAE,IAAI,CAACjB,UAAU,CAACkB,CAAE,CAAC;IACvF,IAAI,CAAC4B,aAAa,CAACjB,QAAQ,GAAG/C,UAAU;IAExC,IAAI,CAACiE,aAAa,GAAG,IAAIhE,cAAc,CAAE;MACxCqD,QAAQ,EAAEpD,aAAa,CAACsC,KAAK,CAAE7B,sBAAsB,CAAC2C,QAAS,CAAC;MAChEL,OAAO,EAAEC,MAAM,CAACC,MAAM,CAAE,CAAC,CAAC,EAAExC,sBAAsB,CAACsC,OAAQ,CAAC;MAC5DI,YAAY,EAAE1C,sBAAsB,CAAC0C,YAAY;MACjDD,cAAc,EAAEzC,sBAAsB,CAACyC;IACxC,CAAE,CAAC;IACH,IAAI,CAACa,aAAa,CAAChB,OAAO,CAAE,eAAe,CAAE,GAAG,CAAC;IACjD,IAAI,CAACgB,aAAa,CAAChB,OAAO,CAAE,oBAAoB,CAAE,GAAG,IAAI,CAAChC,MAAM,CAACwC,mBAAmB,GAAG,CAAC,GAAG,CAAC;IAC5F,IAAI,CAACQ,aAAa,CAACX,QAAQ,CAAE,UAAU,CAAE,CAACI,KAAK,GAAG,IAAI,CAACnB,4BAA4B,CAACoB,OAAO;IAC3F,IAAI,CAACM,aAAa,CAACX,QAAQ,CAAE,QAAQ,CAAE,CAACI,KAAK,GAAGjB,YAAY;IAC5D,IAAI,CAACwB,aAAa,CAACX,QAAQ,CAAE,MAAM,CAAE,CAACI,KAAK,CAACE,GAAG,CAAE,IAAI,CAAC1C,UAAU,CAACiB,CAAC,EAAE,IAAI,CAACjB,UAAU,CAACkB,CAAE,CAAC;IACvF,IAAI,CAAC6B,aAAa,CAAClB,QAAQ,GAAG/C,UAAU;IAExC,IAAI,CAACkE,YAAY,GAAG,IAAIjE,cAAc,CAAE;MACvCqD,QAAQ,EAAEpD,aAAa,CAACsC,KAAK,CAAE3B,UAAU,CAACyC,QAAS,CAAC;MACpDD,YAAY,EAAExC,UAAU,CAACwC,YAAY;MACrCD,cAAc,EAAEvC,UAAU,CAACuC,cAAc;MACzCL,QAAQ,EAAE/C;IACX,CAAE,CAAC;IACH,IAAI,CAACkE,YAAY,CAACC,WAAW,GAAG,IAAI;IACpC,IAAI,CAACD,YAAY,CAACE,SAAS,GAAG,KAAK;IACnC,IAAI,CAACF,YAAY,CAACG,UAAU,GAAG,KAAK;IACpC,IAAI,CAACH,YAAY,CAACnB,QAAQ,GAAGtD,cAAc;IAC3C,IAAI,CAACyE,YAAY,CAACI,QAAQ,GAAG1E,cAAc;IAC3C,IAAI,CAACsE,YAAY,CAACK,QAAQ,GAAGhE,UAAU;IACvC,IAAI,CAAC2D,YAAY,CAACM,aAAa,GAAGjF,WAAW;IAC7C,IAAI,CAAC2E,YAAY,CAACO,aAAa,GAAG9E,cAAc;IAChD,IAAI,CAACuE,YAAY,CAACQ,aAAa,GAAGnE,UAAU;IAC5C,IAAI,CAAC2D,YAAY,CAACS,kBAAkB,GAAGpF,WAAW;IAElD,IAAI,CAACqF,MAAM,GAAG,IAAInE,cAAc,CAAE,IAAK,CAAC;EAEzC;EAEAoE,MAAMA,CAAEC,QAAQ,EAAEC,WAAW,EAAEC,UAAU,8BAA8B;IAEtE;IACA,IAAK,IAAI,CAACC,cAAc,EAAG;MAE1B,IAAI,CAACf,YAAY,CAACnB,QAAQ,GAAG/C,UAAU;MACvC,IAAI,CAACkE,YAAY,CAACZ,QAAQ,CAAE,UAAU,CAAE,CAACI,KAAK,GAAGsB,UAAU,CAACrB,OAAO;MACnE,IAAI,CAACO,YAAY,CAACgB,WAAW,GAAG,IAAI;MACpC,IAAI,CAACC,UAAU,CAAEL,QAAQ,EAAE,IAAI,CAACZ,YAAY,EAAE,IAAK,CAAC;IAErD;IAEAY,QAAQ,CAACM,aAAa,CAAE,IAAI,CAAC9D,cAAe,CAAC;IAC7C,IAAI,CAACC,aAAa,GAAGuD,QAAQ,CAACO,aAAa,CAAC,CAAC;IAC7C,MAAMC,YAAY,GAAGR,QAAQ,CAACS,SAAS;IACvCT,QAAQ,CAACS,SAAS,GAAG,KAAK;IAE1B,IAAI,CAACvC,WAAW,CAACM,QAAQ,CAAE,MAAM,CAAE,CAACI,KAAK,GAAG,IAAI,CAAClC,MAAM,CAACE,OAAO;IAC/D,IAAI,CAACsB,WAAW,CAACM,QAAQ,CAAE,WAAW,CAAE,CAACI,KAAK,GAAG,IAAI,CAAClC,MAAM,CAACG,YAAY;IACzE,IAAI,CAACqB,WAAW,CAACM,QAAQ,CAAE,OAAO,CAAE,CAACI,KAAK,GAAG,IAAI,CAAClC,MAAM,CAACI,QAAQ;IACjE,IAAI,CAACoB,WAAW,CAACM,QAAQ,CAAE,cAAc,CAAE,CAACI,KAAK,GAAG,IAAI,CAAClC,MAAM,CAACK,eAAe;IAC/E,IAAI,CAACmB,WAAW,CAACM,QAAQ,CAAE,eAAe,CAAE,CAACI,KAAK,GAAG,IAAI,CAAClC,MAAM,CAACM,gBAAgB;IACjF,IAAI,CAACkB,WAAW,CAACM,QAAQ,CAAE,YAAY,CAAE,CAACI,KAAK,GAAG,IAAI,CAACzC,MAAM,CAACuE,IAAI;IAClE,IAAI,CAACxC,WAAW,CAACM,QAAQ,CAAE,WAAW,CAAE,CAACI,KAAK,GAAG,IAAI,CAACzC,MAAM,CAACwE,GAAG;IAChE;;IAEA,MAAMC,WAAW,GAAG,IAAI,CAAClE,MAAM,CAACU,kBAAkB,IAAK,IAAI,CAACjB,MAAM,CAACwE,GAAG,GAAG,IAAI,CAACxE,MAAM,CAACuE,IAAI,CAAE;IAC3F,IAAI,CAACxB,aAAa,CAACV,QAAQ,CAAE,aAAa,CAAE,CAACI,KAAK,GAAGgC,WAAW;IAChE,IAAI,CAACzB,aAAa,CAACX,QAAQ,CAAE,aAAa,CAAE,CAACI,KAAK,GAAGgC,WAAW;IAEhE,IAAI,CAAC1B,aAAa,CAACV,QAAQ,CAAE,YAAY,CAAE,CAACI,KAAK,GAAG,IAAI,CAACzC,MAAM,CAACuE,IAAI;IACpE,IAAI,CAACxB,aAAa,CAACV,QAAQ,CAAE,WAAW,CAAE,CAACI,KAAK,GAAG,IAAI,CAACzC,MAAM,CAACwE,GAAG;IAClE,IAAI,CAACxB,aAAa,CAACX,QAAQ,CAAE,YAAY,CAAE,CAACI,KAAK,GAAG,IAAI,CAACzC,MAAM,CAACuE,IAAI;IACpE,IAAI,CAACvB,aAAa,CAACX,QAAQ,CAAE,WAAW,CAAE,CAACI,KAAK,GAAG,IAAI,CAACzC,MAAM,CAACwE,GAAG;IAElE,IAAI,CAACjE,MAAM,CAACQ,aAAa,GAAG2D,IAAI,CAACC,KAAK,CAAE,IAAI,CAACpE,MAAM,CAACQ,aAAc,CAAC;IACnE,IAAO,IAAI,CAAC6D,UAAU,KAAK,IAAI,CAACrE,MAAM,CAACS,aAAa,IAAQ,IAAI,CAAC6D,cAAc,KAAK,IAAI,CAACtE,MAAM,CAACQ,aAAe,EAAG;MAEjHpB,eAAe,CAACmF,SAAS,CAAE,IAAI,CAAC/B,aAAa,EAAE,IAAI,CAACxC,MAAM,CAACQ,aAAa,EAAE,IAAI,CAACR,MAAM,CAACS,aAAa,EAAE,IAAI5B,OAAO,CAAE,CAAC,EAAE,CAAE,CAAE,CAAC;MAC1HO,eAAe,CAACmF,SAAS,CAAE,IAAI,CAAC9B,aAAa,EAAE,IAAI,CAACzC,MAAM,CAACQ,aAAa,EAAE,IAAI,CAACR,MAAM,CAACS,aAAa,EAAE,IAAI5B,OAAO,CAAE,CAAC,EAAE,CAAE,CAAE,CAAC;MAC1H,IAAI,CAACwF,UAAU,GAAG,IAAI,CAACrE,MAAM,CAACS,aAAa;MAC3C,IAAI,CAAC6D,cAAc,GAAG,IAAI,CAACtE,MAAM,CAACQ,aAAa;IAEhD;;IAEA;IACA,IAAI,CAACgE,cAAc,CAAElB,QAAQ,EAAE,IAAI,CAAChC,cAAc,EAAE,IAAI,CAACH,kBAAkB,EAAE,QAAQ,EAAE,GAAI,CAAC;;IAE5F;IACA,IAAI,CAACwC,UAAU,CAAEL,QAAQ,EAAE,IAAI,CAAC9B,WAAW,EAAE,IAAI,CAACX,eAAe,EAAE,QAAQ,EAAE,GAAI,CAAC;;IAElF;IACA,IAAK,IAAI,CAACb,MAAM,CAACO,OAAO,EAAG;MAE1B,IAAI,CAACoD,UAAU,CAAEL,QAAQ,EAAE,IAAI,CAACd,aAAa,EAAE,IAAI,CAACzB,4BAA4B,EAAE,QAAQ,EAAE,GAAI,CAAC;MACjG,IAAI,CAAC4C,UAAU,CAAEL,QAAQ,EAAE,IAAI,CAACb,aAAa,EAAE,IAAI,CAAC5B,eAAe,EAAE,QAAQ,EAAE,GAAI,CAAC;IAErF;IAEA,MAAM4D,cAAc,GAAG,IAAI,CAAC/B,YAAY;;IAExC;IACA,IAAK,IAAI,CAAC1C,MAAM,CAACC,MAAM,KAAKX,OAAO,CAACoF,MAAM,CAACC,MAAM,EAAG;MAEnD,IAAI,CAACjC,YAAY,CAACZ,QAAQ,CAAE,UAAU,CAAE,CAACI,KAAK,GAAG,IAAI,CAACf,kBAAkB,CAACgB,OAAO;MAChF,IAAI,CAACO,YAAY,CAACgB,WAAW,GAAG,IAAI;IAErC,CAAC,MAAM;MAEN,IAAI,CAAChB,YAAY,CAACZ,QAAQ,CAAE,UAAU,CAAE,CAACI,KAAK,GAAG,IAAI,CAACrB,eAAe,CAACsB,OAAO;MAC7E,IAAI,CAACO,YAAY,CAACgB,WAAW,GAAG,IAAI;IAErC;;IAEA;IACA,IAAK,IAAI,CAAC1D,MAAM,CAACC,MAAM,KAAKX,OAAO,CAACoF,MAAM,CAACE,OAAO,EAAG;MAEpDH,cAAc,CAAClD,QAAQ,GAAGtD,cAAc;IAEzC,CAAC,MAAM;MAENwG,cAAc,CAAClD,QAAQ,GAAG/C,UAAU;IAErC;;IAEA;IACA,IAAI,CAACmF,UAAU,CAAEL,QAAQ,EAAEmB,cAAc,EAAE,IAAI,CAAChB,cAAc,GAAG,IAAI,GAAGD,UAAW,CAAC;IAEpFF,QAAQ,CAACuB,aAAa,CAAE,IAAI,CAAC/E,cAAc,EAAE,IAAI,CAACC,aAAc,CAAC;IACjEuD,QAAQ,CAACS,SAAS,GAAGD,YAAY;EAElC;EAEAH,UAAUA,CAAEL,QAAQ,EAAEwB,YAAY,EAAEC,YAAY,EAAEC,UAAU,EAAEC,UAAU,EAAG;IAE1E;IACA3B,QAAQ,CAACM,aAAa,CAAE,IAAI,CAAC/D,kBAAmB,CAAC;IACjD,MAAMqF,kBAAkB,GAAG5B,QAAQ,CAACO,aAAa,CAAC,CAAC;IACnD,MAAMsB,iBAAiB,GAAG7B,QAAQ,CAACS,SAAS;IAE5CT,QAAQ,CAAC8B,eAAe,CAAEL,YAAa,CAAC;;IAExC;IACAzB,QAAQ,CAACS,SAAS,GAAG,KAAK;IAC1B,IAAOiB,UAAU,KAAKK,SAAS,IAAQL,UAAU,KAAK,IAAM,EAAG;MAE9D1B,QAAQ,CAACuB,aAAa,CAAEG,UAAW,CAAC;MACpC1B,QAAQ,CAACgC,aAAa,CAAEL,UAAU,IAAI,GAAI,CAAC;MAC3C3B,QAAQ,CAAC3D,KAAK,CAAC,CAAC;IAEjB;IAEA,IAAI,CAACyD,MAAM,CAACmC,QAAQ,GAAGT,YAAY;IACnC,IAAI,CAAC1B,MAAM,CAACC,MAAM,CAAEC,QAAS,CAAC;;IAE9B;IACAA,QAAQ,CAACS,SAAS,GAAGoB,iBAAiB;IACtC7B,QAAQ,CAACuB,aAAa,CAAE,IAAI,CAAChF,kBAAmB,CAAC;IACjDyD,QAAQ,CAACgC,aAAa,CAAEJ,kBAAmB,CAAC;EAE7C;EAEAV,cAAcA,CAAElB,QAAQ,EAAEkC,gBAAgB,EAAET,YAAY,EAAEC,UAAU,EAAEC,UAAU,EAAG;IAElF3B,QAAQ,CAACM,aAAa,CAAE,IAAI,CAAC/D,kBAAmB,CAAC;IACjD,MAAMqF,kBAAkB,GAAG5B,QAAQ,CAACO,aAAa,CAAC,CAAC;IACnD,MAAMsB,iBAAiB,GAAG7B,QAAQ,CAACS,SAAS;IAE5CT,QAAQ,CAAC8B,eAAe,CAAEL,YAAa,CAAC;IACxCzB,QAAQ,CAACS,SAAS,GAAG,KAAK;IAE1BiB,UAAU,GAAGQ,gBAAgB,CAACR,UAAU,IAAIA,UAAU;IACtDC,UAAU,GAAGO,gBAAgB,CAACP,UAAU,IAAIA,UAAU;IACtD,IAAOD,UAAU,KAAKK,SAAS,IAAQL,UAAU,KAAK,IAAM,EAAG;MAE9D1B,QAAQ,CAACuB,aAAa,CAAEG,UAAW,CAAC;MACpC1B,QAAQ,CAACgC,aAAa,CAAEL,UAAU,IAAI,GAAI,CAAC;MAC3C3B,QAAQ,CAAC3D,KAAK,CAAC,CAAC;IAEjB;IAEA,IAAI,CAACH,KAAK,CAACgG,gBAAgB,GAAGA,gBAAgB;IAC9ClC,QAAQ,CAACD,MAAM,CAAE,IAAI,CAAC7D,KAAK,EAAE,IAAI,CAACC,MAAO,CAAC;IAC1C,IAAI,CAACD,KAAK,CAACgG,gBAAgB,GAAG,IAAI;;IAElC;IACAlC,QAAQ,CAACS,SAAS,GAAGoB,iBAAiB;IACtC7B,QAAQ,CAACuB,aAAa,CAAE,IAAI,CAAChF,kBAAmB,CAAC;IACjDyD,QAAQ,CAACgC,aAAa,CAAEJ,kBAAmB,CAAC;EAE7C;EAEAO,OAAOA,CAAEC,KAAK,EAAEC,MAAM,EAAG;IAExB,IAAI,CAAC9E,eAAe,CAAC4E,OAAO,CAAEC,KAAK,EAAEC,MAAO,CAAC;IAC7C,IAAI,CAAC5E,4BAA4B,CAAC0E,OAAO,CAAEC,KAAK,EAAEC,MAAO,CAAC;IAC1D,IAAI,CAACxE,kBAAkB,CAACsE,OAAO,CAAEC,KAAK,EAAEC,MAAO,CAAC;IAEhD,IAAI,CAACnE,WAAW,CAACM,QAAQ,CAAE,MAAM,CAAE,CAACI,KAAK,CAACE,GAAG,CAAEsD,KAAK,EAAEC,MAAO,CAAC;IAC9D,IAAI,CAACnE,WAAW,CAACM,QAAQ,CAAE,+BAA+B,CAAE,CAACI,KAAK,CAACG,IAAI,CAAE,IAAI,CAAC5C,MAAM,CAAC6C,uBAAwB,CAAC;IAC9G,IAAI,CAACd,WAAW,CAACM,QAAQ,CAAE,wBAAwB,CAAE,CAACI,KAAK,GAAG,IAAI,CAACzC,MAAM,CAAC8C,gBAAgB;IAC1F,IAAI,CAACf,WAAW,CAACkC,WAAW,GAAG,IAAI;IAEnC,IAAI,CAAClB,aAAa,CAACV,QAAQ,CAAE,MAAM,CAAE,CAACI,KAAK,CAACE,GAAG,CAAEsD,KAAK,EAAEC,MAAO,CAAC;IAChE,IAAI,CAACnD,aAAa,CAACkB,WAAW,GAAG,IAAI;IAErC,IAAI,CAACjB,aAAa,CAACX,QAAQ,CAAE,MAAM,CAAE,CAACI,KAAK,CAACE,GAAG,CAAEsD,KAAK,EAAEC,MAAO,CAAC;IAChE,IAAI,CAAClD,aAAa,CAACiB,WAAW,GAAG,IAAI;EAEtC;EAEAkC,OAAOA,CAAA,EAAG;IAET,IAAI,CAAC/E,eAAe,CAAC+E,OAAO,CAAC,CAAC;IAC9B,IAAI,CAAC7E,4BAA4B,CAAC6E,OAAO,CAAC,CAAC;IAC3C,IAAI,CAACzE,kBAAkB,CAACyE,OAAO,CAAC,CAAC;IAEjC,IAAI,CAACtE,cAAc,CAACsE,OAAO,CAAC,CAAC;IAC7B,IAAI,CAACpE,WAAW,CAACoE,OAAO,CAAC,CAAC;IAC1B,IAAI,CAACpD,aAAa,CAACoD,OAAO,CAAC,CAAC;IAC5B,IAAI,CAACnD,aAAa,CAACmD,OAAO,CAAC,CAAC;IAC5B,IAAI,CAAClD,YAAY,CAACkD,OAAO,CAAC,CAAC;IAE3B,IAAI,CAACxC,MAAM,CAACwC,OAAO,CAAC,CAAC;EAEtB;AAED;AAEAtG,OAAO,CAACoF,MAAM,GAAG;EAChB,SAAS,EAAE,CAAC;EACZ,KAAK,EAAE,CAAC;EACR,QAAQ,EAAE;AACX,CAAC;AAED,SAASpF,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}