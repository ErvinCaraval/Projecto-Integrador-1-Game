{"ast":null,"code":"import { DataTexture, FloatType, MathUtils, RedFormat, LuminanceFormat, ShaderMaterial, UniformsUtils } from 'three';\nimport { Pass, FullScreenQuad } from './Pass.js';\nimport { DigitalGlitch } from '../shaders/DigitalGlitch.js';\nclass GlitchPass extends Pass {\n  constructor(dt_size = 64) {\n    super();\n    const shader = DigitalGlitch;\n    this.uniforms = UniformsUtils.clone(shader.uniforms);\n    this.heightMap = this.generateHeightmap(dt_size);\n    this.uniforms['tDisp'].value = this.heightMap;\n    this.material = new ShaderMaterial({\n      uniforms: this.uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader\n    });\n    this.fsQuad = new FullScreenQuad(this.material);\n    this.goWild = false;\n    this.curF = 0;\n    this.generateTrigger();\n  }\n  render(renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */) {\n    if (renderer.capabilities.isWebGL2 === false) this.uniforms['tDisp'].value.format = LuminanceFormat;\n    this.uniforms['tDiffuse'].value = readBuffer.texture;\n    this.uniforms['seed'].value = Math.random(); //default seeding\n    this.uniforms['byp'].value = 0;\n    if (this.curF % this.randX == 0 || this.goWild == true) {\n      this.uniforms['amount'].value = Math.random() / 30;\n      this.uniforms['angle'].value = MathUtils.randFloat(-Math.PI, Math.PI);\n      this.uniforms['seed_x'].value = MathUtils.randFloat(-1, 1);\n      this.uniforms['seed_y'].value = MathUtils.randFloat(-1, 1);\n      this.uniforms['distortion_x'].value = MathUtils.randFloat(0, 1);\n      this.uniforms['distortion_y'].value = MathUtils.randFloat(0, 1);\n      this.curF = 0;\n      this.generateTrigger();\n    } else if (this.curF % this.randX < this.randX / 5) {\n      this.uniforms['amount'].value = Math.random() / 90;\n      this.uniforms['angle'].value = MathUtils.randFloat(-Math.PI, Math.PI);\n      this.uniforms['distortion_x'].value = MathUtils.randFloat(0, 1);\n      this.uniforms['distortion_y'].value = MathUtils.randFloat(0, 1);\n      this.uniforms['seed_x'].value = MathUtils.randFloat(-0.3, 0.3);\n      this.uniforms['seed_y'].value = MathUtils.randFloat(-0.3, 0.3);\n    } else if (this.goWild == false) {\n      this.uniforms['byp'].value = 1;\n    }\n    this.curF++;\n    if (this.renderToScreen) {\n      renderer.setRenderTarget(null);\n      this.fsQuad.render(renderer);\n    } else {\n      renderer.setRenderTarget(writeBuffer);\n      if (this.clear) renderer.clear();\n      this.fsQuad.render(renderer);\n    }\n  }\n  generateTrigger() {\n    this.randX = MathUtils.randInt(120, 240);\n  }\n  generateHeightmap(dt_size) {\n    const data_arr = new Float32Array(dt_size * dt_size);\n    const length = dt_size * dt_size;\n    for (let i = 0; i < length; i++) {\n      const val = MathUtils.randFloat(0, 1);\n      data_arr[i] = val;\n    }\n    const texture = new DataTexture(data_arr, dt_size, dt_size, RedFormat, FloatType);\n    texture.needsUpdate = true;\n    return texture;\n  }\n  dispose() {\n    this.material.dispose();\n    this.heightMap.dispose();\n    this.fsQuad.dispose();\n  }\n}\nexport { GlitchPass };","map":{"version":3,"names":["DataTexture","FloatType","MathUtils","RedFormat","LuminanceFormat","ShaderMaterial","UniformsUtils","Pass","FullScreenQuad","DigitalGlitch","GlitchPass","constructor","dt_size","shader","uniforms","clone","heightMap","generateHeightmap","value","material","vertexShader","fragmentShader","fsQuad","goWild","curF","generateTrigger","render","renderer","writeBuffer","readBuffer","capabilities","isWebGL2","format","texture","Math","random","randX","randFloat","PI","renderToScreen","setRenderTarget","clear","randInt","data_arr","Float32Array","length","i","val","needsUpdate","dispose"],"sources":["/home/ervin/Escritorio/integrador/Projecto-Integrador-1-Game/node_modules/three/examples/jsm/postprocessing/GlitchPass.js"],"sourcesContent":["import {\n\tDataTexture,\n\tFloatType,\n\tMathUtils,\n\tRedFormat,\n\tLuminanceFormat,\n\tShaderMaterial,\n\tUniformsUtils\n} from 'three';\nimport { Pass, FullScreenQuad } from './Pass.js';\nimport { DigitalGlitch } from '../shaders/DigitalGlitch.js';\n\nclass GlitchPass extends Pass {\n\n\tconstructor( dt_size = 64 ) {\n\n\t\tsuper();\n\n\t\tconst shader = DigitalGlitch;\n\n\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\tthis.heightMap = this.generateHeightmap( dt_size );\n\n\t\tthis.uniforms[ 'tDisp' ].value = this.heightMap;\n\n\t\tthis.material = new ShaderMaterial( {\n\t\t\tuniforms: this.uniforms,\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader\n\t\t} );\n\n\t\tthis.fsQuad = new FullScreenQuad( this.material );\n\n\t\tthis.goWild = false;\n\t\tthis.curF = 0;\n\t\tthis.generateTrigger();\n\n\t}\n\n\trender( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tif ( renderer.capabilities.isWebGL2 === false ) this.uniforms[ 'tDisp' ].value.format = LuminanceFormat;\n\n\t\tthis.uniforms[ 'tDiffuse' ].value = readBuffer.texture;\n\t\tthis.uniforms[ 'seed' ].value = Math.random();//default seeding\n\t\tthis.uniforms[ 'byp' ].value = 0;\n\n\t\tif ( this.curF % this.randX == 0 || this.goWild == true ) {\n\n\t\t\tthis.uniforms[ 'amount' ].value = Math.random() / 30;\n\t\t\tthis.uniforms[ 'angle' ].value = MathUtils.randFloat( - Math.PI, Math.PI );\n\t\t\tthis.uniforms[ 'seed_x' ].value = MathUtils.randFloat( - 1, 1 );\n\t\t\tthis.uniforms[ 'seed_y' ].value = MathUtils.randFloat( - 1, 1 );\n\t\t\tthis.uniforms[ 'distortion_x' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'distortion_y' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.curF = 0;\n\t\t\tthis.generateTrigger();\n\n\t\t} else if ( this.curF % this.randX < this.randX / 5 ) {\n\n\t\t\tthis.uniforms[ 'amount' ].value = Math.random() / 90;\n\t\t\tthis.uniforms[ 'angle' ].value = MathUtils.randFloat( - Math.PI, Math.PI );\n\t\t\tthis.uniforms[ 'distortion_x' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'distortion_y' ].value = MathUtils.randFloat( 0, 1 );\n\t\t\tthis.uniforms[ 'seed_x' ].value = MathUtils.randFloat( - 0.3, 0.3 );\n\t\t\tthis.uniforms[ 'seed_y' ].value = MathUtils.randFloat( - 0.3, 0.3 );\n\n\t\t} else if ( this.goWild == false ) {\n\n\t\t\tthis.uniforms[ 'byp' ].value = 1;\n\n\t\t}\n\n\t\tthis.curF ++;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\tif ( this.clear ) renderer.clear();\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t}\n\n\tgenerateTrigger() {\n\n\t\tthis.randX = MathUtils.randInt( 120, 240 );\n\n\t}\n\n\tgenerateHeightmap( dt_size ) {\n\n\t\tconst data_arr = new Float32Array( dt_size * dt_size );\n\t\tconst length = dt_size * dt_size;\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tconst val = MathUtils.randFloat( 0, 1 );\n\t\t\tdata_arr[ i ] = val;\n\n\t\t}\n\n\t\tconst texture = new DataTexture( data_arr, dt_size, dt_size, RedFormat, FloatType );\n\t\ttexture.needsUpdate = true;\n\t\treturn texture;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.material.dispose();\n\n\t\tthis.heightMap.dispose();\n\n\t\tthis.fsQuad.dispose();\n\n\t}\n\n}\n\nexport { GlitchPass };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}