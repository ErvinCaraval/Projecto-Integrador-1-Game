{"ast":null,"code":"/**\n * MMD Toon Shader\n *\n * This shader is extended from MeshPhongMaterial, and merged algorithms with\n * MeshToonMaterial and MeshMetcapMaterial.\n * Ideas came from https://github.com/mrdoob/three.js/issues/19609\n *\n * Combining steps:\n *  * Declare matcap uniform.\n *  * Add gradientmap_pars_fragment.\n *  * Use gradient irradiances instead of dotNL irradiance from MeshPhongMaterial.\n *    (Replace lights_phong_pars_fragment with lights_mmd_toon_pars_fragment)\n *  * Add mmd_toon_matcap_fragment.\n */\n\nimport { UniformsUtils, ShaderLib } from 'three';\nconst lights_mmd_toon_pars_fragment = /* glsl */`\nvarying vec3 vViewPosition;\n\nstruct BlinnPhongMaterial {\n\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n`;\nconst mmd_toon_matcap_fragment = /* glsl */`\n#ifdef USE_MATCAP\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\tvec4 matcapColor = texture2D( matcap, uv );\n\n\t#ifdef MATCAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight *= matcapColor.rgb;\n\n\t#elif defined( MATCAP_BLENDING_ADD )\n\n\t\toutgoingLight += matcapColor.rgb;\n\n\t#endif\n\n#endif\n`;\nconst MMDToonShader = {\n  name: 'MMDToonShader',\n  defines: {\n    TOON: true,\n    MATCAP: true,\n    MATCAP_BLENDING_ADD: true\n  },\n  uniforms: UniformsUtils.merge([ShaderLib.toon.uniforms, ShaderLib.phong.uniforms, ShaderLib.matcap.uniforms]),\n  vertexShader: ShaderLib.phong.vertexShader.replace('#include <envmap_pars_vertex>', '').replace('#include <envmap_vertex>', ''),\n  fragmentShader: ShaderLib.phong.fragmentShader.replace('#include <common>', `\n\t\t\t\t\t#ifdef USE_MATCAP\n\t\t\t\t\t\tuniform sampler2D matcap;\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#include <common>\n\t\t\t\t`).replace('#include <envmap_common_pars_fragment>', `\n\t\t\t\t\t#include <gradientmap_pars_fragment>\n\t\t\t\t`).replace('#include <envmap_pars_fragment>', '').replace('#include <lights_phong_pars_fragment>', lights_mmd_toon_pars_fragment).replace('#include <envmap_fragment>', `\n\t\t\t\t\t${mmd_toon_matcap_fragment}\n\t\t\t\t`)\n};\nexport { MMDToonShader };","map":{"version":3,"names":["UniformsUtils","ShaderLib","lights_mmd_toon_pars_fragment","mmd_toon_matcap_fragment","MMDToonShader","name","defines","TOON","MATCAP","MATCAP_BLENDING_ADD","uniforms","merge","toon","phong","matcap","vertexShader","replace","fragmentShader"],"sources":["/home/ervin/Escritorio/integrador/Projecto-Integrador-1-Game/node_modules/three/examples/jsm/shaders/MMDToonShader.js"],"sourcesContent":["/**\n * MMD Toon Shader\n *\n * This shader is extended from MeshPhongMaterial, and merged algorithms with\n * MeshToonMaterial and MeshMetcapMaterial.\n * Ideas came from https://github.com/mrdoob/three.js/issues/19609\n *\n * Combining steps:\n *  * Declare matcap uniform.\n *  * Add gradientmap_pars_fragment.\n *  * Use gradient irradiances instead of dotNL irradiance from MeshPhongMaterial.\n *    (Replace lights_phong_pars_fragment with lights_mmd_toon_pars_fragment)\n *  * Add mmd_toon_matcap_fragment.\n */\n\nimport { UniformsUtils, ShaderLib } from 'three';\n\nconst lights_mmd_toon_pars_fragment = /* glsl */`\nvarying vec3 vViewPosition;\n\nstruct BlinnPhongMaterial {\n\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n`;\n\nconst mmd_toon_matcap_fragment = /* glsl */`\n#ifdef USE_MATCAP\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\tvec4 matcapColor = texture2D( matcap, uv );\n\n\t#ifdef MATCAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight *= matcapColor.rgb;\n\n\t#elif defined( MATCAP_BLENDING_ADD )\n\n\t\toutgoingLight += matcapColor.rgb;\n\n\t#endif\n\n#endif\n`;\n\nconst MMDToonShader = {\n\n\tname: 'MMDToonShader',\n\n\tdefines: {\n\t\tTOON: true,\n\t\tMATCAP: true,\n\t\tMATCAP_BLENDING_ADD: true,\n\t},\n\n\tuniforms: UniformsUtils.merge( [\n\t\tShaderLib.toon.uniforms,\n\t\tShaderLib.phong.uniforms,\n\t\tShaderLib.matcap.uniforms,\n\t] ),\n\n\tvertexShader:\n\t\tShaderLib.phong.vertexShader\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_pars_vertex>',\n\t\t\t\t''\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_vertex>',\n\t\t\t\t''\n\t\t\t),\n\n\tfragmentShader:\n\t\tShaderLib.phong.fragmentShader\n\t\t\t.replace(\n\t\t\t\t'#include <common>',\n\t\t\t\t`\n\t\t\t\t\t#ifdef USE_MATCAP\n\t\t\t\t\t\tuniform sampler2D matcap;\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#include <common>\n\t\t\t\t`\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_common_pars_fragment>',\n\t\t\t\t`\n\t\t\t\t\t#include <gradientmap_pars_fragment>\n\t\t\t\t`\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_pars_fragment>',\n\t\t\t\t''\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <lights_phong_pars_fragment>',\n\t\t\t\tlights_mmd_toon_pars_fragment\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_fragment>',\n\t\t\t\t`\n\t\t\t\t\t${mmd_toon_matcap_fragment}\n\t\t\t\t`\n\t\t\t)\n\n};\n\nexport { MMDToonShader };\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,aAAa,EAAEC,SAAS,QAAQ,OAAO;AAEhD,MAAMC,6BAA6B,GAAG,UAAW;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAED,MAAMC,wBAAwB,GAAG,UAAW;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAED,MAAMC,aAAa,GAAG;EAErBC,IAAI,EAAE,eAAe;EAErBC,OAAO,EAAE;IACRC,IAAI,EAAE,IAAI;IACVC,MAAM,EAAE,IAAI;IACZC,mBAAmB,EAAE;EACtB,CAAC;EAEDC,QAAQ,EAAEV,aAAa,CAACW,KAAK,CAAE,CAC9BV,SAAS,CAACW,IAAI,CAACF,QAAQ,EACvBT,SAAS,CAACY,KAAK,CAACH,QAAQ,EACxBT,SAAS,CAACa,MAAM,CAACJ,QAAQ,CACxB,CAAC;EAEHK,YAAY,EACXd,SAAS,CAACY,KAAK,CAACE,YAAY,CAC1BC,OAAO,CACP,+BAA+B,EAC/B,EACD,CAAC,CACAA,OAAO,CACP,0BAA0B,EAC1B,EACD,CAAC;EAEHC,cAAc,EACbhB,SAAS,CAACY,KAAK,CAACI,cAAc,CAC5BD,OAAO,CACP,mBAAmB,EAClB;AACL;AACA;AACA;AACA;AACA;AACA,KACG,CAAC,CACAA,OAAO,CACP,wCAAwC,EACvC;AACL;AACA,KACG,CAAC,CACAA,OAAO,CACP,iCAAiC,EACjC,EACD,CAAC,CACAA,OAAO,CACP,uCAAuC,EACvCd,6BACD,CAAC,CACAc,OAAO,CACP,4BAA4B,EAC3B;AACL,OAAOb,wBAAyB;AAChC,KACG;AAEH,CAAC;AAED,SAASC,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}